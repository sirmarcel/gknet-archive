# data obtained from web plot digitizer, fig 4.a
raw = r"""
273.9415957541918, 140.99282647874773
305.64698997878725, 141.05606433388007
336.0032184916978, 141.1279159832331
366.35944700460834, 141.2716192819391
396.7156755175189, 141.38885092035719
427.0719040304293, 141.49662839438673
457.42813254333987, 141.58927920539455
487.7843610562504, 141.67814835064698
491.8318581913052, 141.88361885669156
517.1287152853973, 141.74495777899276
531.2949552580889, 141.87731608043254
554.5680637846536, 142.09034991798796
560.6393094872357, 141.8710133041735
560.6393094872357, 141.7386550027337
586.2734580092491, 142.09161047323977
616.7983322361202, 142.24917987971568
609.2092751078925, 142.07270214446265
646.9859150350702, 142.305904866047
633.494257918221, 142.1168215782759
677.3421435479808, 142.42775854038837
663.8504864311316, 142.2680882084928
708.6259234876746, 142.5753485511208
703.7472439052427, 142.32211200499881
739.3073973060806, 142.70838215001692
736.7054348621169, 142.47607982504098
730.6341891595347, 142.34372152360123
768.4108290867124, 142.8416408480651
765.0379148075, 142.5958325739627
798.767057599623, 142.99290747828198
795.3941433204105, 142.74709920417956
827.7741204008486, 142.99794969928922
835.8691146709581, 142.86054917684223
859.7861431962814, 143.10521149162483
883.4272060078512, 143.3080462912338
888.4865774266694, 143.1189630034627
900.6290688318337, 142.9739991495049
920.1919716512651, 143.2996425895551
918.84280593958, 143.13787133223983
945.7297511938722, 143.57276289411334
949.1990344524905, 143.34046056913743
955.2702801550728, 143.2702296336796
975.7607344012873, 143.56567227082192
983.6027601004558, 143.4593129214507
985.6265086679833, 143.78453617641696
1007.8877429107844, 143.5444004009477
1017.3319028925788, 143.81226839195674
1038.5330783619129, 143.60517717201697
1048.940928137768, 143.85098544611938
1078.0443599184, 143.94252576797683
1070.6239485041328, 143.75554340562542
1097.510893758425, 144.16162227602905
1109.653385163589, 143.96983779843265
1127.8671222713356, 144.2912793876435
1137.407651232536, 144.03916833728206
1157.8981054787505, 144.32436896300345
1169.7876283129735, 144.13370998116758
1178.894496866847, 144.55599599052303
1189.3505311324052, 144.2723710588664
1210.262599663521, 144.57017723710587
1216.3338453661036, 144.34800437397485
1235.8967481855348, 144.77449223416966
1247.4489795918366, 144.4803626754146
1267.5057734307243, 144.93956494571583
1264.9038109867602, 144.69150568009232
1277.0463023919242, 144.6316293056315
1295.2600394996707, 145.05517587023874
1295.2600394996707, 144.86609258246764
1303.3550337697802, 144.67890012757425
1317.5212737424717, 144.65684041066763
1328.218230456545, 145.08542919628212
1325.6162680125813, 144.8774375797339
1340.3607218617094, 145.3015243823062
1358.2492136639603, 145.02634066885363
1343.8300051203278, 144.8774375797339
1368.1149879306558, 145.28207581556404
1385.5698193255794, 145.07597503189356
1399.8203821552515, 145.41737541259135
1417.5522743659676, 145.13405061313753
1430.176610668162, 145.50561428021788
1430.8511935240044, 145.3060263653484
1459.1836734693875, 145.7585657007472
1459.1836734693875, 145.54553186319177
1456.7551751883548, 145.36527246218333
1490.8890676939832, 145.87117530324198
1489.539901982298, 145.60729907053033
1484.6829054202326, 145.4635957718243
1521.2452962068937, 145.86277160156328
1515.848633360154, 145.59280268513456
1525.9673761977906, 145.55813741570984
1544.181113305537, 146.04502688172042
1549.3850381934644, 145.75802546278214
1569.8152618275508, 146.21992892290868
1577.5729646697387, 145.95521232002915
1595.0277960646622, 146.4231934572626
1598.8223246287762, 146.1896755968653
1612.4826274595862, 146.08284353927465
1623.8662131519272, 146.4042851284855
1643.5977616853193, 146.59809549845087
1640.5621388340282, 146.22465600510296
1670.8099522451066, 146.72775261006535
1671.6772730597613, 146.4997721888099
1669.6535244922343, 146.33653028370085
1703.382667284357, 146.8333991454549
1702.0335015726719, 146.5678421724075
1700.0097530051448, 146.37119555312555
1710.533245556287, 146.26152724621832
1726.3184843830004, 147.13225578640422
1726.3184843830004, 146.88487181823703
1726.3184843830004, 146.69893991859544
1723.2828615317094, 146.50355385456533
1726.3184843830004, 146.20102059413156
1739.3282966028196, 142.65976073316148
1736.4372272206374, 142.40044650993255
1746.555970058274, 143.18829354231212
1744.532221490747, 142.8769363951157
1744.532221490747, 142.24728904683798
1764.7697071660205, 142.99921025454103
1771.419166745039, 142.6381512145591
1767.8053300173115, 142.4035978980621
1772.86470143613, 143.169385213535
1777.3169482846902, 142.85424640058318
1798.414527101163, 142.5800756333151
1805.244678516568, 143.12526577972176
1805.244678516568, 142.90718972115909
1809.7981127935045, 142.7029797703663
1824.470289908078, 143.3017435149748
1838.2028694734422, 143.0703415866073
1835.6009070294785, 142.86180973209403
1829.529661326896, 142.74079642792054
1849.0925641463277, 143.4467073689326
1868.5590979863528, 143.17838917961936
1865.957135542389, 142.93303110382115
1863.5286372613564, 142.74457809367595
1872.0283812449711, 143.70133952979768
1878.0996269475531, 143.5122562420266
1880.1233755150806, 143.34586294878804
1897.0722697681222, 143.17096090759978
1904.9865722018453, 143.74023666328202
1895.099114914783, 142.9260980499362
1910.4796040279912, 143.5286434603001
1910.4796040279912, 143.31434906749286
1933.9550874113083, 143.8223528339712
1940.8358325409013, 143.6357906567037
1938.8120839733742, 143.43662292691815
1932.7408382707922, 143.24501852864344
1928.6933411357372, 143.04963246461332
1953.2312925170068, 144.27946168215783
1950.9545753785383, 144.04168944778567
1970.0356333009395, 143.83207711734227
1969.1683124862848, 143.54912748314197
1986.1678004535147, 144.38014853289593
1981.3108038914488, 144.10849887613145
1991.0247970155806, 143.4782212502278
2001.8012581376638, 143.9556565518498
1999.5245409991953, 143.70133952979768
2010.1492209787139, 144.36691270275196
2019.7620266744689, 144.19673774375795
2017.7382781069418, 143.49622918239646
2029.8807695121059, 143.94336613814468
2032.4827319560695, 143.72402952433023
2050.696469063816, 144.35070556380015
2048.0945066198524, 144.1173227628941
2056.594250603467, 144.5484326590122
2060.995903737839, 143.91783989429558
2063.2726208763074, 143.7287566065245
2063.2726208763074, 145.00979588117366
2070.3557408626534, 144.79550148836643
2078.4507351327625, 144.2723710588664
2087.1239432793086, 144.55599599052303
2102.735717943091, 144.8207125934026
2108.806963645673, 144.2534627300893
2112.854460780728, 144.9593736711014
2116.9019579157825, 144.61272097685438
2114.8782093482555, 144.41229269181702
2114.8782093482555, 144.098414434117
2136.56122971462, 144.82611497305317
2143.2106892936386, 144.52448210922785
2144.222563577402, 144.30073355203206
2153.582400702216, 145.05706670311645
2165.7248921073806, 144.72144386732276
2179.38519493819, 144.4992710041917
2183.0110777883433, 145.119044002997
2183.179723502304, 144.8585292509568
2199.8756491844047, 145.35014579916165
2204.597729175302, 144.65053763440858
2214.620103033533, 145.11784347418572
2212.018140589569, 144.89634590851102
2208.982517738278, 144.42363768908328
2219.3036354326673, 145.67915071988335
2221.125009143442, 145.95521232002915
2232.5085948357837, 145.41159786768725
2233.267500548606, 144.7041112326104
2244.9763315464434, 145.16646489104116
2240.856557676834, 144.94361673045378
2256.5406090751712, 145.6337707308183
2262.6118547777533, 145.41947633801104
2274.7543461829173, 145.2051819452038
2268.1771633384537, 145.02870420995077
2281.0785604564408, 145.91266858028067
2286.896837588082, 145.64637628333637
2290.9443347231363, 145.43334244578094
2299.4440787067515, 145.2215691634773
2309.158071830883, 146.12066019682885
2309.158071830883, 145.87201567340986
2316.241191817229, 145.64637628333637
2319.7827518104014, 146.3806497175141
2323.902525680011, 145.41497435496888
2341.5380489113204, 146.2388372516858
2339.5143003437934, 146.02328230362676
2339.5143003437934, 145.83419901585566
2339.5143003437934, 146.59809549845087
2347.609294613903, 145.64322489520686
2354.08529002999, 146.40901221067978
2353.174603174603, 145.45414160743576
2371.6919025674783, 146.09513395297975
2367.8467802891764, 145.84176234736648
2374.4239631336404, 146.70209130672498
2384.0367688293954, 146.54767328837858
2383.5308316875135, 146.3428330599599
2398.492115740305, 146.10647895024601
2398.203008802087, 145.85121651175504
2414.392997342306, 146.617003827228
2414.645965913247, 146.35228722434846
2421.0424569213246, 146.98706683329428
2416.922683051715, 146.7588162930563
2427.547363031234, 147.28824949881536
2432.606734450052, 147.11492315169187
2445.0021944261575, 146.47046427920537
2442.725477287689, 146.23379503067855
2436.654231585107, 146.09387339772795
2448.796722990271, 146.84863085474757
2448.796722990271, 146.6737288135593
2461.698120108258, 147.35915573172954
2461.951088679199, 147.09601482291475
2454.8679686928535, 147.656961909969
2473.0817058005996, 146.52246218334244
2462.9629629629626, 146.20312151955125
2480.5021172148668, 146.81869266751715
2492.644608620031, 147.42586011380433
2491.295442908346, 147.16534536176417
2493.319191475873, 147.0014731790292
2502.4260600297466, 147.83974242148108
2504.9557457391556, 147.656961909969
2503.43793431351, 146.62834882449425
2511.5329285836197, 146.8123898912581
2524.2536338652203, 147.4678786221979
2518.6160485699656, 147.2409786768726
2518.6160485699656, 147.0518953891015
2535.143328538106, 148.05193588886863
2533.7941628264207, 147.78553854565337
2535.817911393948, 147.60653969989673
2537.8416599614757, 148.28723953587266
2543.9129056640577, 146.8123898912581
2555.3808142133794, 147.36283235121397
2547.960402799112, 147.1716481380232
2566.4271084777997, 148.0114930745398
2564.1503913393312, 147.7628485511208
2564.1503913393312, 147.58132859486057
2561.11476848804, 147.11807453982138
2574.7750713188498, 148.19584928011662
2558.079145636749, 146.81554127938765
2582.3641284470777, 147.36388281392382
2589.1942798624823, 148.52438149261891
2596.7833369907103, 147.81295562238017
2594.506619852242, 147.5737652633497
2601.9270312665085, 148.19059696656743
2600.577865554824, 147.97840349917988
2614.744105527516, 148.96163659558957
2612.7203569599883, 148.75364497904135
2613.732231243752, 147.37333697831235
2620.815351230098, 148.55825891501124
2620.309414088216, 148.35657007472207
2626.380659790798, 147.69477856752323
2618.7916026625703, 147.54351193730636
2633.5360565116985, 148.18639511572806
2630.9340940677343, 147.94436850738109
2640.040962621608, 149.40913370998115
2637.0053397703164, 149.1923182066703
2645.1003340404263, 148.99315047688475
2643.076585472899, 148.78389830508473
2651.1715797430084, 148.58977279630642
2650.6656426011264, 148.38493256788772
2650.3620803159974, 147.74015855658828
2663.892285024609, 148.16208440730037
2652.183454026772, 147.97840349917988
2669.6382854216954, 149.44852606160015
2667.361568283227, 149.20744486969198
2675.456562553337, 149.037269910698
2673.4328139858094, 148.8141516311281
2679.5040596883914, 149.8503280481137
2679.5040596883914, 149.66880809185346
2680.515933972155, 148.58977279630642
2676.4684368371004, 148.3660242391106
2682.5396825396824, 148.17694095133953
2698.585117610792, 149.38572339816187
2703.78904249872, 149.16206488062693
2705.8127910662474, 148.95848520746006
2702.574793358203, 148.75364497904135
2712.13700533977, 149.67542600692545
2705.0032916392365, 148.50405503918353
2717.9552824714115, 149.92596136322214
2712.895911052593, 150.53102788408967
2722.002779606466, 150.26631128121014
2719.9790310389385, 150.10243909847517
2730.3507424475165, 149.36343858210313
2736.169019579158, 149.13181155458355
2734.1452710116305, 148.91247494076907
2734.1452710116305, 148.7422999817751
2742.818479158176, 149.6072209638366
2742.24026528174, 148.57716724378832
2748.311510984322, 149.83772249559564
2753.226328934031, 150.19608034575228
2750.335259551849, 150.0394113358848
2767.1034619685047, 150.6066611991981
2764.501499524541, 150.38732458538362
2766.778216663009, 149.31380421906323
2762.9836880988955, 149.0845407326408
2762.9836880988955, 148.8954574448697
2762.9836880988955, 148.72055540368143
2772.5964937946505, 149.54149201142093
2766.0193109501865, 148.55038044468742
2776.643990929705, 149.84560096591943
2773.608368078414, 151.06046108984873
2773.608368078414, 150.87137780207763
2781.5009874917705, 150.13017131401494
2786.7627337673416, 150.51842233157157
2782.715236632287, 150.34194459631857
2786.7627337673416, 149.21374764595103
2785.750859483578, 148.952182431201
2782.715236632287, 148.8292782941498
2788.786482334869, 149.6612447603426
2788.786482334869, 149.4721614725715

"""

import xarray as xr
import numpy as np
import io


with io.StringIO(raw) as f:
    data = np.loadtxt(f, delimiter=",")

set_temp = data[:, 0]
vol = data[:, 1]

set_temp = xr.DataArray(set_temp, dims=("step"), name="external_temperature")
vol = xr.DataArray(vol, dims=("step"), name="volume")

dataset = xr.Dataset(
    {
        "external_temperature": set_temp,
        "volume": vol,
    }
)

dataset.to_netcdf("verdi.nc")
